[[数学]] [[随机过程]] [[概率论]] [[高斯分布]]
# 扩散模型数学基础：微积分（一） 微分与积分

## 一、微积分基础

微积分的核心就是**极限**，**微分**和**积分**以及他们应用，比如微分方程。这些知识通常理工科非常基础的知识，不再赘述。我们一步一步来。

### 1.1 高斯积分

从最简单的开始，由于扩散模型和高斯分布以及高斯过程密切相关，于是我们首先要考察一个特殊的积分：
$$
I(a)=\int_{-\infty}^{+\infty}\exp\left(-ax^2\right) dx
$$
这是一个非常简单的积分：
$$
\begin{aligned}
I^2(a) &= \left(\int_{-\infty}^{+\infty}\exp\left(-ax^2\right) dx\right)\left(\int_{-\infty}^{+\infty}\exp\left(-ay^2\right) dy\right) \\
&=\iint_{\mathbb R^2}\exp\left(-a\rho^2\right)\rho d\rho d\theta\\
&=\int_0^{2\pi}d\theta\int_0^{+\infty}\exp\left(-a\rho^2\right)\rho d\rho \\
&=\left.2\pi\cdot\left(-\frac1{2a}\exp\left(-a\rho^2\right)\right)\right|_0^{+\infty}\\
&=\frac{\pi}{a}
\end{aligned}
$$
因此
$$
I(a)=\int_{-\infty}^{+\infty}\exp\left(-ax^2\right) dx=\sqrt[]{\frac{\pi}{a}}
$$

### 1.2 矩阵微积分

扩散模型中的推导会使用到非常多的矩阵微积分。

#### 1.2.1 矩阵微分

|   类型   |                  输入                  |             输出             |                           导数形式                           |    示例    |
| :------: | :------------------------------------: | :--------------------------: | :----------------------------------------------------------: | :--------: |
| 标量函数 |           $x\in \mathbb{R}$            |      $f\in \mathbb{R}$       |               $\mathrm{d}f = f'(x)\mathrm{d}x$               | 单变量微分 |
| 向量输入 |      $\mathbf{x}\in \mathbb{R}^n$      |      $f\in \mathbb{R}$       | $\mathrm{d}f = \nabla_{\mathbf{x}}f^\top \mathrm{d}\mathbf{x}$  |    梯度    |
| 向量输出 |      $\mathbf{x}\in \mathbb{R}^n$      | $\mathbf{y}\in \mathbb{R}^m$ |            $d\mathbf{y} = J\mathrm{d}\mathbf{x}$             | 雅可比矩阵 |
| 矩阵输入 | $\mathbf{X}\in \mathbb{R}^{m\times n}$ |      $f\in \mathbb{R}$       | $\mathrm{d}f = \mathrm{Tr}\left((\displaystyle\frac{\partial f}{\partial \mathbf{X}})^\top \mathrm{d}\mathbf{X}\right)$ |  矩阵梯度  |

我们要时刻关注我们的研究对象是标量还是向量，还是矩阵，接下来稍微详细地讨论下。

从输出来看，如果输出仅仅是一个数值的话，即$f\in\mathbb R$，这其实可以看作我们在高等数学中学习过的**多元微分学**，即
$$
y=f(x_1,x_2,\cdots,x_n)
$$
那对于其中任意的一个变量，有偏导数：
$$
\frac{\partial f}{\partial x_i}=\partial_{x_i}f
$$
那么全微分公式为
$$
\mathrm{d}f=\sum_{i=1}^n\frac{\partial f}{\partial x_i}\mathrm{d}x_i
$$
拆成两个向量$\displaystyle\frac{\partial f}{\partial \mathbf{x}}^\top=\displaystyle\left[\begin{matrix}\frac{\partial f}{\partial x_1} & \frac{\partial f}{\partial x_2}&\cdots &\frac{\partial f}{\partial x_n}\end{matrix}\right]^\top$和$\mathrm{d}\mathbf{x}=\displaystyle\left[\begin{matrix}\mathrm{d}x_1 & \mathrm{d}x_2 & \cdots &\mathrm{d}x_n\end{matrix}\right]^\top$，可以将上述的微分写成向量内积：
$$
\mathrm{d}f=\frac{\partial f}{\partial \mathbf{x}}^\top\mathrm{d}\mathbf{x}
$$
进而介绍一个非常重要的微分算子：Nabla $\nabla$：
$$
\nabla_{\mathbf{x}}=\left[
\begin{matrix}
	\frac{\partial}{\partial x_1}\\
	\frac{\partial}{\partial x_2}\\
	\vdots \\
	\frac{\partial}{\partial x_n}\\
\end{matrix}

\right],\nabla_{\mathbf{x}}f=\left[
\begin{matrix}
	\frac{\partial f}{\partial x_1}\\
	\frac{\partial f}{\partial x_2}\\
	\vdots \\
	\frac{\partial f}{\partial x_n}\\
\end{matrix}

\right]
$$
这是一个算子，可以理解为一个输入为函数的函数，$\nabla_{\mathbf x}f$称为函数$f(\mathbf{x})$的**梯度（Gradient）**

现在如果有一堆的这样的函数：
$$
\mathbf{f}(\mathbf{x})=\left[
\begin{matrix}
	f_1(\mathbf{x})\\
	f_2(\mathbf{x})\\
	\vdots\\
	f_m(\mathbf{x})
\end{matrix}
\right]\in\mathbb R^m,\mathbf{f}:\mathbb R^n\rightarrow\mathbb R^m
$$
此时梯度称之为**雅可比矩阵（Jacobian Matrix）**：
$$
\mathbf{J}=\frac{\partial \mathbf{f(x)}}{\partial\mathbf{x}^\top}=\left[

\begin{matrix}
	\frac{\partial f_1}{\partial x_1} & \frac{\partial f_1}{\partial x_2} & \cdots&\frac{\partial f_1}{\partial x_n}\\
	\frac{\partial f_2}{\partial x_1} & \frac{\partial f_2}{\partial x_2} & \cdots&\frac{\partial f_2}{\partial x_n}\\
	\vdots &\vdots &\ddots &\vdots\\
	\frac{\partial f_m}{\partial x_1} & \frac{\partial f_m}{\partial x_2} & \cdots&\frac{\partial f_m}{\partial x_n}
\end{matrix}

\right]
$$

> 这里有一个可能的误会或者容易混淆的地方就是，在不同的领域里，是否**转置（Transpose）**是一个问题。例如
>
> |          名称          |                             定义                             | 矩阵形式           | 谁在用                                                   |
> | :--------------------: | :----------------------------------------------------------: | ------------------ | -------------------------------------------------------- |
> |  **Numerator layout**  | $\displaystyle \frac{\partial f}{\partial \mathbf{x}} = \begin{bmatrix} \frac{\partial f}{\partial x_1} & \frac{\partial f}{\partial x_2} & \cdots & \frac{\partial f}{\partial x_n} \end{bmatrix}$ | 行向量 $1\times n$ | 数学家、统计学文献                                       |
> | **Denominator layout** | $\displaystyle \frac{\partial f}{\partial \mathbf{x}} = \begin{bmatrix} \frac{\partial f}{\partial x_1} \\ \frac{\partial f}{\partial x_2} \\ \vdots \\ \frac{\partial f}{\partial x_n} \end{bmatrix}$ | 列向量 $n\times1$  | 工程、机器学习（PyTorch、TensorFlow、Deep Learning书籍） |
>

无论如何，我们遵循矩阵的乘法规则，$\mathbf{J}\in\mathbb R^{m\times n}$，那么就是$m\times 1$的矩阵和$1\times n$的矩阵相乘，所以$\partial \mathbf{x}^\top$要转置。

其他的算子：

|                           符号                            |        名称         |              对象               |       结果       |
| :-------------------------------------------------------: | :-----------------: | :-----------------------------: | :--------------: |
|                 $\mathrm{grad}f=\nabla f$                 |    梯度 / 雅可比    | $f:\mathbb{R}^n\to\mathbb{R}^m$ | $m\times n$矩阵  |
|              $\mathrm{div}f=\nabla \cdot f$               |        散度         | $f:\mathbb{R}^n\to\mathbb{R}^n$ |    标量（迹）    |
|             $\mathrm{curl}f=\nabla \times f$              |        旋度         | $f:\mathbb{R}^3\to\mathbb{R}^3$ | 向量（仅3D定义） |
|                 $\mathrm{H}f=\nabla^2 f$                  | Hessian（海森矩阵） |  $f:\mathbb{R}^n\to\mathbb{R}$  | $n\times n$矩阵  |
| $\Delta f=\mathrm{Tr}(\mathrm{H}f)=\nabla\cdot(\nabla f)$ |      拉普拉斯       |  $f:\mathbb{R}^n\to\mathbb{R}$  |       标量       |

### 1.3 微分方程

#### 1.3.1 一阶常系数线性微分方程

齐次线性微分方程：
$$
\frac{\mathrm{d}y}{\mathrm{d}x}+ay=0
$$
求解很简单：
$$
\begin{aligned}
&\frac{\mathrm{d}y}{\mathrm{d}x}+ay=0 \\
&\Rightarrow \frac{\mathrm{d}y}{y}=-a\ \mathrm{d}x \\
&\Rightarrow \ln\left|y\right|=-ax+C\\
&\Rightarrow y=\exp\left(-ax+C\right)\\
&\Rightarrow y=C'\exp\left(-ax\right)
\end{aligned}
$$
其中$C$和$C'$都是常数。

非齐次线性微分方程：
$$
\frac{\mathrm{d}y}{\mathrm{d}x}+ay=f(x)
$$
可以通过各种方法得到特解，由通解和特解得到：
$$
y=\exp\left(-ax\right)\left(\int\exp\left(ax\right)f(x)\mathrm{d}x+C\right)
$$

#### 1.3.2 偏微分方程

有一个这样的方程：
$$
F\left(x_1,x_2,\cdots,x_n,u, \frac{\partial u}{\partial x_1},\cdots,\frac{\partial^2u}{\partial x_i\partial x_j},\cdots\right) = 0
$$
称为偏微分方程。

常见的偏微分方程：

| PDE 名称               | 方程形式                                                     | 对应物理现象               |
| ---------------------- | ------------------------------------------------------------ | -------------------------- |
| **Laplace 方程**       | $u_{xx} + u_{yy} = 0$                                        | 稳态热流、电势场           |
| **Poisson 方程**       | $u_{xx} + u_{yy} = f(x,y)$                                   | 有源稳态场                 |
| **热传导（扩散）方程** | $u_t = D u_{xx}$                                             | **热传导、布朗运动**       |
| **波动方程**           | $u_{tt} = c^2 u_{xx}$                                        | 声波、电磁波               |
| **对流方程**           | $u_t + v u_x = 0$                                            | 流体输运                   |
| **Fokker–Planck 方程** | $\partial_t p = -\nabla\cdot(fp) + \frac{1}{2}\nabla^2(\sigma^2 p)$ | 概率密度的演化（随机过程） |
| **Navier–Stokes 方程** | $\rho(\partial_t u + (u\cdot\nabla)u) = -\nabla p + \mu\nabla^2u$ | 流体动力学                 |

后面我们会从爱因斯坦的角度探索下热传导（扩散）方程的由来，接下来通过一种变量分离法进行求解热传导扩散方程（抛物线方程）。
#### 1.3.3 热传导（扩散）方程求解 —— 变量分离法

##### 问题定义

给定方程：
$$
\frac{\partial u}{\partial t}=\alpha \frac{\partial^2 u}{\partial x^2}, 0<x<L
$$
其中$u=u(x,t)$，有如下边界条件：
- $u(0,t)=0$, $u(L,t)=0$
- $u(x,0)=f(x)$
这里要求函数$f(x)$比较光滑，是$L^2(0,L)$或者更加光滑（如$C^2$）。

##### 变量分离 — 设解并得到本征问题

设
$$
u(x,t)=X(x)T(t)
$$
代入PDE后，得到：
$$
X(x)T'(t)=\alpha X''(x)T(t)
$$

除以$\alpha XT$得到：
$$
\frac{T'(t)}{\alpha T(t)} = \frac{X''(x)}{X(x)}=-\lambda
$$
其中$\lambda$为常数，于是得到两条ODE：
$$
\left\{
	\begin{aligned}
	&X''(x)+\lambda X(x) = 0 &0<x<L\\
	&T'(t)+\alpha\lambda T(t)=0&t>0\\
	\end{aligned}
\right.
$$
因此问题化作一个 Sturm–Liouville 本征值问题：
$$
X''+\lambda X=0, X(0)=X(L)=0
$$
##### 求本征值与本征函数（特征解）

考虑$\lambda$的符号三种情况：
1. $\lambda < 0$：设$\lambda=-\mu^2$，得到
   $$
   X''-\mu^2X=0\Rightarrow r^2-\mu^2=0\Rightarrow r=\pm\mu\Rightarrow X(x)=Ae^{\mu x}+Be^{-\mu x}
   $$
   由于$X(0)=0,X(L)=0$，得到：
   $$
   \left\{
   \begin{aligned}
   	&A+B=0\\
   	&Ae^{\mu L}+Be^{-\mu L}=0
   \end{aligned}
   \right.\Rightarrow A=-B=0
   $$
   没有$A\ne0$的非平凡解。

2. $\lambda=0$：也只有平凡解

3. $\lambda > 0$：设$\lambda =\kappa^2(\kappa > 0)$，则
   $$
   X''+\kappa^2X=0\Rightarrow r^2+\kappa^2=0\Rightarrow X(x)=A\cos (\kappa x)+B\sin (\kappa x)
   $$
   代入初值得到：$\kappa L=n\pi ,n\in\mathbb Z^+$，则
   $$
   \lambda_n=\left(\frac{n\pi}{L}\right)^2
   $$
   因此：
   $$
   X_n(x)=\sin\left(\frac{n\pi x}{L}\right), n=1,2,\cdots
   $$
##### 对应时间因子与分离解

考察：
$$
T_n'(t)+\alpha\lambda_nT_n(t)=0
$$
求解得到：
$$
T_n(t)=C_n\exp\left(-\alpha\lambda_n t\right)=C_n\exp\left(-\alpha\left(\frac{n\pi}{L}\right)^2t\right)
$$
因此得到：
$$
u_n(x,t)=C_n\exp\left(-\alpha\left(\frac{n\pi}{L}\right)^2t\right)\sin\left(\frac{n\pi x}{L}\right)
$$

##### 通解（傅里叶正弦级数）与系数确定

线性叠加（由线性叠加原理）得到一般解的级数表示：
$$
u(x,t)=\sum_{n=1}^\infty C_n\exp\left(-\alpha\left(\frac{n\pi}{L}\right)^2t\right)\sin\left(\frac{n\pi x}{L}\right)
$$
因为$u(x,0)=f(x)$，给出系数$C_n$：
$$
f(x)=\sum_{n=1}^\infty C_n\sin\left(\frac{n\pi x}{L}\right)
$$
其中任意取两个正线积分：
$$
\int_0^L\sin\left(\frac{n\pi x}{L}\right)\sin\left(\frac{m\pi x}{L}\right)\mathrm{d}x=\frac L2\delta_{mn}
$$
积化和差就可以证明。继续想办法求解$C_n$，我们打开求和公式：
$$
f(x)=C_1\sin\frac{\pi x}L+C_2\sin\frac{2\pi x}{L}+\cdots+C_n\sin\frac{n\pi x}{L}+\cdots
$$
两边乘$\sin\frac{\pi x}{L}$，再一积分，除了第一项外，其他就都是$0$了，那么：
$$
\int_0^Lf(x)\sin\frac{\pi x}{L}\mathrm{d}x=C_1\int_0^L\sin^2\frac{\pi x}{L}\mathrm{d}x=\frac L2C_1
$$
每一个$C$都是这么得到的，因此：
$$
C_n=\frac 2L \int_0^Lf(x)\sin \frac{n\pi x}{L}\mathrm dx
$$
此时求解完成。
### 1.4 泰勒展开

在扩散模型的数学推导中，泰勒展开是连接“离散近似”与“连续极限”的核心工具之一。例如，在分析扩散过程的迭代加噪/去噪步骤时，常需将复杂函数（如概率密度函数、随机过程的状态转移函数）在某点附近近似为简单的多项式，从而简化微分方程的求解或梯度计算。本节将从基础定义出发，逐步延伸至多变量场景，并结合扩散模型的潜在应用场景说明其意义。


#### 1.4.1 单变量函数的泰勒展开
泰勒展开的本质是：**在函数可微的前提下，用“多项式函数”逼近“任意复杂函数”**，逼近的精度由展开的阶数决定，且在“展开点”附近误差最小。

##### 1. 定义（带佩亚诺余项）
设函数 $f(x)$ 在点 $x_0$ 处具有 $n$ 阶导数，则 $f(x)$ 在 $x_0$ 附近可展开为：  
$$
f(x) = \sum_{k=0}^n \frac{f^{(k)}(x_0)}{k!} (x - x_0)^k + o\left((x - x_0)^n\right)
$$
其中：
- $f^{(k)}(x_0)$ 表示 $f(x)$ 在 $x_0$ 处的 $k$ 阶导数（$k=0$ 时为函数值 $f(x_0)$）；
- $k!$ 是 $k$ 的阶乘（$0! = 1$）；
- $o\left((x - x_0)^n\right)$ 为**佩亚诺余项**，表示当 $x \to x_0$ 时，余项是 $(x - x_0)^n$ 的高阶无穷小（即误差远小于 $(x - x_0)^n$）。

##### 2. 常用特例：麦克劳林展开（$x_0 = 0$）
当展开点取 $x_0 = 0$ 时，泰勒展开称为**麦克劳林展开**，形式更简洁，也是扩散模型中最常用的形式（例如对“小噪声扰动”的函数进行近似）。常见函数的麦克劳林展开式如下（需熟记）：
- 指数函数：$\exp(x) = \displaystyle{\sum_{k=0}^\infty \frac{x^k}{k!} = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \cdots}$（收敛域为 $\mathbb{R}$）；
- 正弦函数：$\sin(x) = \displaystyle{\sum_{k=0}^\infty \frac{(-1)^k x^{2k+1}}{(2k+1)!} = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \cdots}$（收敛域为 $\mathbb{R}$）；
- 余弦函数：$\cos(x) = \displaystyle{\sum_{k=0}^\infty \frac{(-1)^k x^{2k}}{(2k)!} = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \cdots}$（收敛域为 $\mathbb{R}$）；
- 自然对数：$\ln(1+x) = \displaystyle{\sum_{k=1}^\infty \frac{(-1)^{k+1} x^k}{k} = x - \frac{x^2}{2} + \frac{x^3}{3} - \cdots}$（收敛域为 $(-1,1]$）。

##### 3. 低阶近似的实际意义（扩散模型视角）
在扩散模型的“前向扩散过程”中，每次加噪步骤仅引入**微小的高斯噪声**（即 $\beta_t$ 很小，$t$ 为扩散步数），此时可对“加噪后的分布函数”进行**一阶或二阶泰勒近似**，将离散的加噪过程转化为连续的微分方程（如《扩散模型数学基础》中后续会涉及的“前向扩散的微分方程形式”）。

例如，设前向扩散中 $t$ 时刻的样本为 $x_t$，$t+\Delta t$ 时刻的样本为 $x_{t+\Delta t}$，且满足 $x_{t+\Delta t} \approx \sqrt{1-\beta_{\Delta t}} x_t + \sqrt{\beta_{\Delta t}} \epsilon$（$\epsilon$ 为高斯噪声）。当 $\Delta t \to 0$ 时，$\beta_{\Delta t} \to 0$，对 $\sqrt{1-\beta_{\Delta t}}$ 做一阶泰勒展开：  
$$
\sqrt{1-\beta_{\Delta t}} \approx 1 - \frac{1}{2}\beta_{\Delta t} + o(\beta_{\Delta t})
$$
忽略高阶小项后，可得到 $x_{t+\Delta t} \approx x_t - \frac{1}{2}\beta_{\Delta t} x_t + \sqrt{\beta_{\Delta t}} \epsilon$，进一步整理为微分形式 $\frac{dx_t}{dt} \approx -\frac{1}{2}\beta_t x_t + \sqrt{\beta_t} \epsilon$，这正是前向扩散连续化的关键一步。


#### 1.4.2 多变量函数的泰勒展开
扩散模型中的变量通常是**高维向量**（如图像样本 $x \in \mathbb{R}^{H \times W \times 3}$ 可展平为向量），因此需要将泰勒展开推广到多变量场景。设多变量函数 $f(\mathbf{x})$，其中 $\mathbf{x} = (x_1, x_2, \dots, x_n)^\top \in \mathbb{R}^n$，且 $f(\mathbf{x})$ 在点 $\mathbf{x}_0 = (x_{01}, x_{02}, \dots, x_{0n})^\top$ 处足够光滑。

##### 1. 一阶泰勒展开（梯度形式）
多变量函数的一阶近似仅包含“函数值”和“梯度项”，形式为：  
$$
f(\mathbf{x}) \approx f(\mathbf{x}_0) + \nabla_{\mathbf{x}} f(\mathbf{x}_0)^\top \cdot (\mathbf{x} - \mathbf{x}_0)
$$
其中：
- $\nabla_{\mathbf{x}} f(\mathbf{x}_0) = \left( \frac{\partial f}{\partial x_1}\bigg|_{\mathbf{x}_0}, \frac{\partial f}{\partial x_2}\bigg|_{\mathbf{x}_0}, \dots, \frac{\partial f}{\partial x_n}\bigg|_{\mathbf{x}_0} \right)^\top$ 是 $f(\mathbf{x})$ 在 $\mathbf{x}_0$ 处的**梯度**（见 1.2 节矩阵微积分）；
- $\nabla_{\mathbf{x}} f(\mathbf{x}_0)^\top \cdot (\mathbf{x} - \mathbf{x}_0)$ 是梯度向量与位移向量 $(\mathbf{x} - \mathbf{x}_0)$ 的**内积**，本质是单变量一阶项在多变量下的推广。

##### 2. 二阶泰勒展开（海森矩阵形式）
二阶近似需引入**海森矩阵（Hessian Matrix）**，考虑函数的曲率信息，精度更高，形式为：  
$$
f(\mathbf{x}) \approx f(\mathbf{x}_0) + \nabla_{\mathbf{x}} f(\mathbf{x}_0)^\top \cdot (\mathbf{x} - \mathbf{x}_0) + \frac{1}{2} (\mathbf{x} - \mathbf{x}_0)^\top \cdot \mathbf{H}_f(\mathbf{x}_0) \cdot (\mathbf{x} - \mathbf{x}_0)
$$
其中 $\mathbf{H}_f(\mathbf{x}_0)$ 是 $f(\mathbf{x})$ 在 $\mathbf{x}_0$ 处的海森矩阵，定义为：  
$$
\mathbf{H}_f(\mathbf{x}_0) = \begin{bmatrix} 
\frac{\partial^2 f}{\partial x_1^2}\bigg|_{\mathbf{x}_0} & \frac{\partial^2 f}{\partial x_1 \partial x_2}\bigg|_{\mathbf{x}_0} & \dots & \frac{\partial^2 f}{\partial x_1 \partial x_n}\bigg|_{\mathbf{x}_0} \\
\frac{\partial^2 f}{\partial x_2 \partial x_1}\bigg|_{\mathbf{x}_0} & \frac{\partial^2 f}{\partial x_2^2}\bigg|_{\mathbf{x}_0} & \dots & \frac{\partial^2 f}{\partial x_2 \partial x_n}\bigg|_{\mathbf{x}_0} \\
\vdots & \vdots & \ddots & \vdots \\
\frac{\partial^2 f}{\partial x_n \partial x_1}\bigg|_{\mathbf{x}_0} & \frac{\partial^2 f}{\partial x_n \partial x_2}\bigg|_{\mathbf{x}_0} & \dots & \frac{\partial^2 f}{\partial x_n^2}\bigg|_{\mathbf{x}_0} 
\end{bmatrix}
$$
海森矩阵是对称矩阵（若二阶混合偏导数连续），其正定性可用于判断函数的极值（正定时 $\mathbf{x}_0$ 为极小值点，负定时为极大值点）—— 这一性质在扩散模型的“去噪网络训练”中可用于分析损失函数的收敛性。


#### 1.4.3 泰勒展开的核心性质与注意事项
1. **局部性**：泰勒展开的精度仅在“展开点 $\mathbf{x}_0$ 附近”有效，远离 $\mathbf{x}_0$ 时误差会急剧增大。在扩散模型中，这对应“每次加噪/去噪步骤仅能处理微小扰动”，因此需要将扩散过程拆分为大量迭代步骤（如 1000 步），确保每一步的近似误差可控。
2. **可微性要求**：展开式成立的前提是函数在 $\mathbf{x}_0$ 处具有足够阶数的导数。扩散模型中涉及的概率密度函数（如高斯分布的概率密度）和神经网络输出函数均满足这一条件，因此泰勒近似是安全的。
3. **余项的意义**：实际应用中常忽略余项（如佩亚诺余项），但需明确“忽略的前提是展开阶数足够高，或扰动足够小”。例如，在连续扩散方程的推导中，忽略高阶小项后得到的微分方程是“近似模型”，但通过设置合理的扩散步数（如 $T=1000$），可使近似误差趋近于零。


#### 1.4.4 小结
泰勒展开是扩散模型中“离散过程连续化”“复杂函数近似化”的核心数学工具：
- 单变量展开用于简化“小噪声扰动下的函数近似”（如前向扩散的微分方程推导）；
- 多变量展开（结合梯度、海森矩阵）用于分析高维样本（如图像）的去噪过程，或优化去噪网络的损失函数；
- 其“局部近似”特性决定了扩散模型需通过多步迭代实现从噪声到样本的生成，而非一步完成。



